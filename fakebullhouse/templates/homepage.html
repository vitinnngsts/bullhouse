<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>BULLHOUSE - Card√°pio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

body {
    margin: 0;
    background: #000;
    color: #fff;
    min-height: 100vh;
}

/* TOURO GIGANTE AO FUNDO */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: url("{{ url_for('static', filename='logo/touro.png') }}") no-repeat center;
    background-size: 70%;
    opacity: 0.10;
    z-index: -1;
}

/* CENTRAL */
.central {
    text-align: center;
    padding: 40px 20px;
}

.central img {
    width: 160px;
    margin-bottom: 20px;
}

h1 {
    font-size: clamp(48px, 8vw, 110px);
    color: #e10600;
    margin: 10px 0;
    text-shadow: 4px 4px 12px black;
}

button {
    background: #e10600;
    color: #fff;
    border: none;
    padding: 14px 28px;
    font-size: 16px;
    border-radius: 14px;
    cursor: pointer;
    margin: 10px;
    transition: 0.2s;
}

button:hover {
    background: #ff1f1f;
    transform: scale(1.05);
}

/* MODAIS */
.modal-cardapio,
.modal-porcoes,
.modal-carrinho {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.95);
    overflow-y: auto;
    z-index: 100;
}

.modal-cardapio-content,
.modal-porcoes-content,
.modal-carrinho-content {
    background: #111;
    max-width: 1200px;
    margin: 40px auto;
    padding: 25px;
    border-radius: 20px;
    position: relative;
}

/* FECHAR */
.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 28px;
    cursor: pointer;
}

/* CARDS */
.cardapio,
.cardapio-porcoes {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
}

.card {
    background: #1a1a1a;
    border-radius: 18px;
    padding: 16px;
    width: 280px;
    cursor: pointer;
    transition: 0.2s;
    border: 1px solid transparent;
}

.card:hover {
    transform: scale(1.05);
    border-color: #e10600;
}

.card img {
    width: 100%;
    max-width: 200px;
}

.card h3 {
    color: #e10600;
}

/* MODAL PRODUTO */
#imagem-produto {
    width: 180px;
    border-radius: 14px;
    margin-bottom: 10px;
}

input, textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 10px;
    border: none;
}

/* CARRINHO √çCONE */
.carrinho-float {
    position: fixed;
    right: 20px;
    bottom: 20px;
    z-index: 200;
}

.carrinho-float button {
    font-size: 24px;
    padding: 16px;
    border-radius: 50%;
}

/* CARRINHO LISTA */
#lista-carrinho div {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 6px 0;
}

#lista-carrinho button {
    background: transparent;
    color: red;
    font-size: 18px;
}
</style>
</head>

<body>

<!-- CENTRAL -->
<div class="central">
    <h1>BULLHOUSE</h1>
    <img src="{{ url_for('static', filename='logo/logo.png') }}">
    <br>
    <button onclick="abrirModal('modal-cardapio')">üçî HAMB√öRGUERES</button>
    <button onclick="abrirModal('modal-porcoes')">üçü POR√á√ïES</button>
</div>

<!-- HAMB√öRGUERES -->
<div id="modal-cardapio" class="modal-cardapio">
<div class="modal-cardapio-content">
<span class="close" onclick="fecharModal('modal-cardapio')">&times;</span>
<h2>üçî HAMB√öRGUERES</h2>

<div class="cardapio">
{% for produto in produtos_hamburguer %}
<div class="card" onclick="abrirModalCarrinho(
{{ produto.id }},
'{{ produto.nome }}',
'{{ produto.imagem }}',
'hamburgueres',
'{{ produto.descricao | replace("\n"," ") }}'
)">
<img src="{{ url_for('static', filename='hamburgueres/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- POR√á√ïES -->
<div id="modal-porcoes" class="modal-porcoes">
<div class="modal-porcoes-content">
<span class="close" onclick="fecharModal('modal-porcoes')">&times;</span>
<h2>üçü POR√á√ïES</h2>

<div class="cardapio-porcoes">
{% for produto in produtos_porcoes %}
<div class="card" onclick="abrirModalCarrinho(
{{ produto.id }},
'{{ produto.nome }}',
'{{ produto.imagem }}',
'porcoes',
'{{ produto.descricao | replace("\n"," ") }}'
)">
<img src="{{ url_for('static', filename='porcoes/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- MODAL PRODUTO -->
<div id="modal-carrinho" class="modal-carrinho">
<div class="modal-carrinho-content">
<span class="close" onclick="fecharModal('modal-carrinho')">&times;</span>

<img id="imagem-produto">
<h2 id="nome-produto"></h2>
<p id="descricao-produto"></p>

<label>Quantidade</label>
<input type="number" id="qtd" value="1">

<label>Observa√ß√µes</label>
<textarea id="obs"></textarea>

<button onclick="adicionarCarrinho()">Adicionar ao carrinho</button>
</div>
</div>

<!-- √çCONE CARRINHO -->
<div class="carrinho-float">
    <button onclick="abrirModal('modal-carrinho-resumo')">üõí</button>
</div>

<!-- MODAL RESUMO CARRINHO -->
<div id="modal-carrinho-resumo" class="modal-carrinho">
<div class="modal-carrinho-content">
<span class="close" onclick="fecharModal('modal-carrinho-resumo')">&times;</span>

<h2>üõí Seu Carrinho</h2>
<div id="lista-carrinho"></div>
<p><strong>Total: R$ <span id="total">0.00</span></strong></p>

<a href="/checkout">
    <button>Finalizar Pedido</button>
</a>
</div>
</div>

<script>
let produtoAtual = {};

function abrirModal(id){ document.getElementById(id).style.display="block"; }
function fecharModal(id){ document.getElementById(id).style.display="none"; }

function abrirModalCarrinho(id,nome,imagem,categoria,descricao){
    produtoAtual={id,nome};
    document.getElementById("nome-produto").innerText=nome;
    document.getElementById("descricao-produto").innerText=descricao;
    document.getElementById("imagem-produto").src="{{ url_for('static', filename='') }}"+categoria+"/"+imagem;
    abrirModal("modal-carrinho");
}

function adicionarCarrinho(){
    fetch("/add_carrinho",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
            id:produtoAtual.id,
            nome:produtoAtual.nome,
            quantidade:document.getElementById("qtd").value,
            observacoes:document.getElementById("obs").value
        })
    }).then(()=>{
        carregarCarrinho();
        fecharModal("modal-carrinho");
    });
}

function carregarCarrinho(){
    fetch("/get_carrinho")
    .then(res=>res.json())
    .then(carrinho=>{
        const lista=document.getElementById("lista-carrinho");
        lista.innerHTML="";
        if(carrinho.length===0){
            lista.innerHTML="<p>Carrinho vazio</p>";
        }
        carrinho.forEach(item=>{
            const div=document.createElement("div");
            div.innerHTML=`${item.nome} x${item.quantidade}
            <button onclick="removerItem(${item.id})">‚ùå</button>`;
            lista.appendChild(div);
        });
        atualizarTotal();
    });
}

function atualizarTotal(){
    fetch("/total")
    .then(res=>res.json())
    .then(data=>{
        document.getElementById("total").innerText=data.total.toFixed(2);
    });
}

function removerItem(id){
    fetch("/remover_carrinho",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({id})
    }).then(()=>carregarCarrinho());
}

window.onload=carregarCarrinho;
</script>

</body>
</html>
