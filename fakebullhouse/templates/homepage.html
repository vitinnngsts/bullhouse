<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>CARD√ÅPIO BULL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= BASE ================= */
body {
    margin: 0;
    min-height: 100vh;
    background:
        linear-gradient(180deg, rgba(0,0,0,0.85), rgba(20,0,0,0.95)),
        url("{{ url_for('static',filename='fundo/fundo.png') }}") no-repeat center;
    background-size: cover;
    color: white;
    font-family: Arial, sans-serif;
}

/* TOURO AVATAR */
body::before {
    content: "";
    position: fixed;
    inset: 0;
    background: url("{{ url_for('static',filename='logo/logo.png') }}") no-repeat center;
    background-size: 55%;
    opacity: 0.22;
    z-index: -1;
}

/* ================= CENTRAL ================= */
.central {
    text-align: center;
    padding: 50px 20px;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(6px);
    border-radius: 24px;
    max-width: 900px;
    margin: 40px auto;
}

h1 {
    font-size: clamp(48px, 8vw, 110px);
    margin-bottom: 10px;
    color: #fff;
    text-shadow: 4px 4px 8px #000;
}

.central img {
    width: 180px;
    margin-bottom: 20px;
}

button {
    margin: 10px;
    padding: 14px 26px;
    font-size: 18px;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    background: #e10600;
    color: white;
    font-weight: bold;
}

button:hover {
    background: #ff1e1e;
}

/* ================= MODAIS ================= */
.modal-cardapio,
.modal-porcoes,
.modal-carrinho {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    overflow-y: auto;
    z-index: 100;
}

.modal-cardapio-content,
.modal-porcoes-content,
.modal-carrinho-content {
    background: #111;
    color: white;
    width: 90%;
    max-width: 1200px;
    margin: 5% auto;
    padding: 25px;
    border-radius: 18px;
    text-align: center;
    position: relative;
}

/* ================= CARDS ================= */
.cardapio,
.cardapio-porcoes {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
}

.card {
    background: #1a1a1a;
    padding: 15px;
    border-radius: 16px;
    width: 280px;
    cursor: pointer;
    transition: transform .2s;
}

.card:hover {
    transform: scale(1.05);
}

.card img {
    width: 180px;
}

/* ================= FECHAR ================= */
.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 26px;
    cursor: pointer;
}

/* ================= CARRINHO FLOAT ================= */
.carrinho-float {
    position: fixed;
    right: 20px;
    bottom: 20px;
    z-index: 200;
}

.btn-carrinho {
    background: #e10600;
    border: none;
    color: white;
    font-size: 28px;
    padding: 16px;
    border-radius: 50%;
    cursor: pointer;
    position: relative;
}

#badge-carrinho {
    position: absolute;
    top: -6px;
    right: -6px;
    background: black;
    color: white;
    font-size: 13px;
    padding: 4px 7px;
    border-radius: 50%;
}

/* ================= CARRINHO LISTA ================= */
#lista-carrinho div {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.remover {
    background: transparent;
    border: none;
    color: red;
    font-size: 18px;
    cursor: pointer;
}
</style>
</head>

<body>

<div class="central">
    <h1>CARD√ÅPIO BULL</h1>
    <img src="{{ url_for('static', filename='logo/logo.png') }}">
    <br>
    <button onclick="abrirModal('modal-cardapio')">üçî HAMB√öRGUERES</button>
    <button onclick="abrirModal('modal-porcoes')">üçü POR√á√ïES</button>
</div>

<!-- ================= HAMB√öRGUERES ================= -->
<div id="modal-cardapio" class="modal-cardapio">
<div class="modal-cardapio-content">
<span class="close" onclick="fecharModal('modal-cardapio')">&times;</span>

<h2>üçî HAMB√öRGUERES</h2>
<div class="cardapio">
{% for produto in produtos_hamburguer %}
<div class="card" onclick="abrirModalCarrinho({{ produto.id }}, '{{ produto.nome }}', '{{ produto.imagem }}', 'hamburgueres', '{{ produto.descricao }}')">
<img src="{{ url_for('static', filename='hamburgueres/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- ================= POR√á√ïES ================= -->
<div id="modal-porcoes" class="modal-porcoes">
<div class="modal-porcoes-content">
<span class="close" onclick="fecharModal('modal-porcoes')">&times;</span>

<h2>üçü POR√á√ïES</h2>
<div class="cardapio-porcoes">
{% for produto in produtos_porcoes %}
<div class="card" onclick="abrirModalCarrinho({{ produto.id }}, '{{ produto.nome }}', '{{ produto.imagem }}', 'porcoes', '{{ produto.descricao }}')">
<img src="{{ url_for('static', filename='porcoes/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- ================= MODAL ADD CARRINHO ================= -->
<div id="modal-carrinho" class="modal-carrinho">
<div class="modal-carrinho-content">
<span class="close" onclick="fecharModal('modal-carrinho')">&times;</span>

<h2 id="nome-produto"></h2>
<p id="descricao-produto"></p>

<label>Quantidade</label><br>
<input type="number" id="qtd" value="1"><br><br>

<label>Observa√ß√µes</label><br>
<textarea id="obs"></textarea><br><br>

<button onclick="adicionarCarrinho()">Adicionar ao carrinho</button>
</div>
</div>

<!-- ================= CARRINHO FLOAT ================= -->
<div class="carrinho-float">
    <button class="btn-carrinho" onclick="carregarCarrinho(); abrirModal('modal-carrinho')">
        üõí
        <span id="badge-carrinho">0</span>
    </button>
</div>

<script>
let produtoAtual = {};

function abrirModal(id){ document.getElementById(id).style.display="block"; }
function fecharModal(id){ document.getElementById(id).style.display="none"; }

function abrirModalCarrinho(id,nome,imagem,categoria,descricao){
    produtoAtual={id,nome};
    document.getElementById("nome-produto").innerText=nome;
    document.getElementById("descricao-produto").innerText=descricao;
    abrirModal("modal-carrinho");
}

function adicionarCarrinho(){
    fetch("/add_carrinho",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
            id:produtoAtual.id,
            nome:produtoAtual.nome,
            quantidade:document.getElementById("qtd").value,
            observacoes:document.getElementById("obs").value
        })
    }).then(()=>{
        carregarCarrinho();
        fecharModal("modal-carrinho");
    });
}

function carregarCarrinho(){
    fetch("/get_carrinho")
    .then(res=>res.json())
    .then(carrinho=>{
        let totalQtd = carrinho.reduce((s,i)=>s+Number(i.quantidade),0);
        document.getElementById("badge-carrinho").innerText = totalQtd;
    });
}

window.onload = carregarCarrinho;
</script>

</body>
</html>
