<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>CARD√ÅPIO BULL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== RESET ===== */
* {
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

/* ===== BODY ===== */
body {
    background-image: url("{{ url_for('static',filename='fundo/fundo.png') }}");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
}

/* ===== CENTRAL ===== */
.central {
    width: 100%;
    max-width: 480px;
    text-align: center;
    background: rgba(0, 0, 0, 0.75);
    padding: 25px;
    border-radius: 20px;
}

h1 {
    font-size: 42px;
    color: #ff7a00;
    margin-bottom: 10px;
    text-shadow: 2px 2px 4px black;
}

.central img {
    width: 140px;
    margin-bottom: 20px;
}

/* ===== BOT√ïES ===== */
.btn-menu {
    width: 100%;
    padding: 14px;
    margin: 10px 0;
    font-size: 18px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    background: #ff7a00;
    color: white;
    font-weight: bold;
}

/* ===== MODAIS ===== */
.modal-cardapio,
.modal-porcoes,
.modal-carrinho {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.95);
    overflow-y: auto;
    z-index: 100;
}

.modal-content {
    background: #111;
    color: white;
    width: 95%;
    max-width: 1000px;
    margin: 40px auto;
    padding: 20px;
    border-radius: 15px;
    position: relative;
}

.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 26px;
    cursor: pointer;
}

/* ===== CARDS ===== */
.cardapio {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.card {
    background: #222;
    padding: 15px;
    border-radius: 15px;
    cursor: pointer;
}

.card img {
    width: 100%;
    max-height: 160px;
    object-fit: contain;
    margin-bottom: 10px;
}

.card h3 {
    margin: 5px 0;
    color: #ff7a00;
}

.card strong {
    display: block;
    margin-top: 8px;
}

/* ===== MODAL PRODUTO ===== */
#imagem-produto {
    width: 140px;
    margin: 10px auto;
    display: block;
}

.modal-carrinho-content input,
.modal-carrinho-content textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 8px;
    border: none;
}

.modal-carrinho-content button {
    width: 100%;
    padding: 14px;
    background: #ff7a00;
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
}

/* ===== CARRINHO FLOAT ===== */
.carrinho-float {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: #ff7a00;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 26px;
    text-decoration: none;
    box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    z-index: 999;
}

.carrinho-float span {
    position: absolute;
    top: -6px;
    right: -6px;
    background: red;
    color: white;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    font-size: 12px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
}
</style>
</head>

<body>

<div class="central">
    <h1>CARD√ÅPIO BULL</h1>
    <img src="{{ url_for('static', filename='logo/logo.png') }}">

    <button class="btn-menu" onclick="abrirModal('modal-cardapio')">üçî Hamb√∫rgueres</button>
    <button class="btn-menu" onclick="abrirModal('modal-porcoes')">üçü Por√ß√µes</button>
</div>

<!-- ===== HAMBURGUERES ===== -->
<div id="modal-cardapio" class="modal-cardapio">
<div class="modal-content">
<span class="close" onclick="fecharModal('modal-cardapio')">&times;</span>
<h2>üçî Hamb√∫rgueres</h2>

<div class="cardapio">
{% for produto in produtos_hamburguer %}
<div class="card" onclick="abrirModalCarrinho(
{{ produto.id }},
'{{ produto.nome }}',
'{{ produto.imagem }}',
'hamburgueres',
'{{ produto.descricao | replace("\n"," ") }}'
)">
<img src="{{ url_for('static', filename='hamburgueres/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- ===== POR√á√ïES ===== -->
<div id="modal-porcoes" class="modal-porcoes">
<div class="modal-content">
<span class="close" onclick="fecharModal('modal-porcoes')">&times;</span>
<h2>üçü Por√ß√µes</h2>

<div class="cardapio">
{% for produto in produtos_porcoes %}
<div class="card" onclick="abrirModalCarrinho(
{{ produto.id }},
'{{ produto.nome }}',
'{{ produto.imagem }}',
'porcoes',
'{{ produto.descricao | replace("\n"," ") }}'
)">
<img src="{{ url_for('static', filename='porcoes/' + produto.imagem) }}">
<h3>{{ produto.nome }}</h3>
<p>{{ produto.descricao }}</p>
<strong>R$ {{ produto.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- ===== MODAL CARRINHO ===== -->
<div id="modal-carrinho" class="modal-carrinho">
<div class="modal-content modal-carrinho-content">
<span class="close" onclick="fecharModal('modal-carrinho')">&times;</span>

<img id="imagem-produto">
<h2 id="nome-produto"></h2>
<p id="descricao-produto"></p>

<label>Quantidade</label>
<input type="number" id="qtd" value="1" min="1">

<label>Observa√ß√µes</label>
<textarea id="obs"></textarea>

<button onclick="adicionarCarrinho()">Adicionar ao carrinho</button>
</div>
</div>

<!-- ===== CARRINHO FLOAT ===== -->
<a href="/checkout" class="carrinho-float">
üõí
<span id="qtd-carrinho">0</span>
</a>

<script>
let produtoAtual = {};

function abrirModal(id) {
    document.getElementById(id).style.display = "block";
}

function fecharModal(id) {
    document.getElementById(id).style.display = "none";
}

function abrirModalCarrinho(id, nome, imagem, categoria, descricao) {
    produtoAtual = { id, nome };
    document.getElementById("nome-produto").innerText = nome;
    document.getElementById("descricao-produto").innerText = descricao;
    document.getElementById("imagem-produto").src =
        "{{ url_for('static', filename='') }}" + categoria + "/" + imagem;
    abrirModal("modal-carrinho");
}

function adicionarCarrinho() {
    fetch("/add_carrinho", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            id: produtoAtual.id,
            nome: produtoAtual.nome,
            quantidade: document.getElementById("qtd").value,
            observacoes: document.getElementById("obs").value
        })
    }).then(() => {
        atualizarQtdCarrinho();
        fecharModal("modal-carrinho");
    });
}

function atualizarQtdCarrinho() {
    fetch("/get_carrinho")
        .then(res => res.json())
        .then(carrinho => {
            const total = carrinho.reduce((s, i) => s + i.quantidade, 0);
            document.getElementById("qtd-carrinho").innerText = total;
        });
}

window.onload = atualizarQtdCarrinho;
</script>

</body>
</html>
