<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>CARD√ÅPIO BULL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= BASE ================= */
body {
    margin: 0;
    min-height: 100vh;
    background: #000;
    color: white;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* TOURO CENTRAL */
.touro {
    position: fixed;
    inset: 0;
    background: url("{{ url_for('static',filename='logo/logo.png') }}") no-repeat center;
    background-size: 60%;
    opacity: 0.35;
    z-index: -1;
}

/* ================= CENTRAL ================= */
.central {
    text-align: center;
    background: rgba(0,0,0,0.65);
    padding: 40px 30px;
    border-radius: 25px;
    max-width: 900px;
}

h1 {
    font-size: clamp(48px, 9vw, 120px);
    margin-bottom: 20px;
    color: #fff;
    text-shadow: 4px 4px 8px #000;
}

button {
    margin: 10px;
    padding: 14px 28px;
    font-size: 18px;
    border-radius: 14px;
    border: none;
    cursor: pointer;
    background: #e10600;
    color: white;
    font-weight: bold;
}

button:hover {
    background: #ff1e1e;
}

/* ================= MODAIS ================= */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    overflow-y: auto;
    z-index: 100;
}

.modal-content {
    background: #111;
    width: 90%;
    max-width: 1200px;
    margin: 5% auto;
    padding: 25px;
    border-radius: 18px;
    text-align: center;
    position: relative;
}

.close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 28px;
    cursor: pointer;
}

/* ================= CARDS ================= */
.cardapio {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
}

.card {
    background: #1a1a1a;
    padding: 15px;
    border-radius: 16px;
    width: 280px;
    cursor: pointer;
    transition: transform .2s;
}

.card:hover { transform: scale(1.05); }

.card img { width: 180px; }

/* ================= CARRINHO FLOAT ================= */
.carrinho-float {
    position: fixed;
    right: 20px;
    bottom: 20px;
    z-index: 200;
}

.btn-carrinho {
    background: #e10600;
    border: none;
    color: white;
    font-size: 26px;
    padding: 16px;
    border-radius: 50%;
    cursor: pointer;
    position: relative;
}

#badge {
    position: absolute;
    top: -6px;
    right: -6px;
    background: black;
    color: white;
    font-size: 13px;
    padding: 4px 7px;
    border-radius: 50%;
}

/* ================= LISTA CARRINHO ================= */
.item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.remover {
    background: transparent;
    border: none;
    color: red;
    font-size: 18px;
    cursor: pointer;
}
</style>
</head>

<body>

<div class="touro"></div>

<div class="central">
    <h1>CARD√ÅPIO BULL</h1>
    <button onclick="abrirModal('hamburgueres')">üçî HAMB√öRGUERES</button>
    <button onclick="abrirModal('porcoes')">üçü POR√á√ïES</button>
</div>

<!-- ================= HAMB√öRGUERES ================= -->
<div id="hamburgueres" class="modal">
<div class="modal-content">
<span class="close" onclick="fecharModal('hamburgueres')">&times;</span>

<div class="cardapio">
{% for p in produtos_hamburguer %}
<div class="card" onclick="abrirAdd({{p.id}}, '{{p.nome}}')">
<img src="{{ url_for('static', filename='hamburgueres/' + p.imagem) }}">
<h3>{{ p.nome }}</h3>
<p>{{ p.descricao }}</p>
<strong>R$ {{ p.preco }}</strong>
</div>
{% endfor %}
</div>
</div>
</div>

<!-- ================= ADD ================= -->
<div id="add" class="modal">
<div class="modal-content">
<span class="close" onclick="fecharModal('add')">&times;</span>

<h2 id="nome"></h2>
<label>Quantidade</label><br>
<input type="number" id="qtd" value="1"><br><br>
<button onclick="addCarrinho()">Adicionar</button>
</div>
</div>

<!-- ================= CARRINHO ================= -->
<div id="carrinho" class="modal">
<div class="modal-content">
<span class="close" onclick="fecharModal('carrinho')">&times;</span>

<h2>üõí Carrinho</h2>
<div id="lista"></div>

<a href="/checkout">
<button>Finalizar Pedido</button>
</a>
</div>
</div>

<!-- ================= BOT√ÉO CARRINHO ================= -->
<div class="carrinho-float">
<button class="btn-carrinho" onclick="abrirCarrinho()">
üõí <span id="badge">0</span>
</button>
</div>

<script>
let atual = {};

function abrirModal(id){ document.getElementById(id).style.display="block"; }
function fecharModal(id){ document.getElementById(id).style.display="none"; }

function abrirAdd(id,nome){
    atual={id,nome};
    document.getElementById("nome").innerText=nome;
    abrirModal("add");
}

function addCarrinho(){
    fetch("/add_carrinho",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
            id:atual.id,
            nome:atual.nome,
            quantidade:document.getElementById("qtd").value
        })
    }).then(()=>{
        fecharModal("add");
        atualizarCarrinho();
    });
}

function abrirCarrinho(){
    atualizarCarrinho();
    abrirModal("carrinho");
}

function atualizarCarrinho(){
    fetch("/get_carrinho")
    .then(r=>r.json())
    .then(c=>{
        const lista=document.getElementById("lista");
        lista.innerHTML="";
        let total=0;

        c.forEach(i=>{
            total+=Number(i.quantidade);
            lista.innerHTML+=`
            <div class="item">
                ${i.nome} x${i.quantidade}
                <button class="remover" onclick="remover(${i.id})">‚ùå</button>
            </div>`;
        });

        document.getElementById("badge").innerText=total;
    });
}

function remover(id){
    fetch("/remover_carrinho",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({id})
    }).then(atualizarCarrinho);
}

window.onload = atualizarCarrinho;
</script>

</body>
</html>
